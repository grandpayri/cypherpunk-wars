<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-RYPTO-NOMICON | Era 01</title>
    <style>
        :root {
            --kaspa-teal: #70C7BA;
            --kaspa-bright: #49EACB;
            --kaspa-dark: #0A0A0A;
            --kaspa-glow: rgba(112, 199, 186, 0.3);
        }

        body {
            background-color: var(--kaspa-dark);
            color: var(--kaspa-teal);
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 5px var(--kaspa-glow);
            margin: 0; padding: 20px;
            display: flex; flex-direction: column; align-items: center;
            height: 100vh; overflow: hidden;
        }

        /* CRT Overlay */
        body::before {
            content: " "; display: block; position: fixed;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            background-size: 100% 4px; z-index: 10; pointer-events: none;
        }

        .terminal-container {
            border: 2px solid var(--kaspa-teal);
            background: rgba(112, 199, 186, 0.02);
            box-shadow: inset 0 0 20px var(--kaspa-glow);
            width: 95%; max-width: 900px; padding: 20px;
            position: relative; z-index: 5;
        }

        .yri-ascii {
            font-size: 8px; line-height: 8px; white-space: pre;
            color: var(--kaspa-bright); text-align: center; margin: 10px 0;
        }

        .log-area {
            height: 180px; overflow-y: auto; border: 1px solid #333;
            background: #000; padding: 10px; font-size: 0.85rem;
            margin-top: 20px; color: var(--kaspa-bright);
        }

        button {
            background: transparent; border: 1px solid var(--kaspa-teal);
            color: var(--kaspa-teal); padding: 10px 15px; cursor: pointer;
            text-transform: uppercase; font-family: 'Courier New', monospace;
        }

        .input-field {
            background: #000; border: 1px solid var(--kaspa-teal);
            color: var(--kaspa-bright); padding: 8px; width: 200px;
        }
    </style>
</head>
<body>

<div class="terminal-container">
    <div style="text-align: center;">
        <h1>K-RYPTO-NOMICON v1.0</h1>
        <p>BLOCKDAG_STRATEGY_PROTOCOL // ERA_01</p>
    </div>

    <div class="yri-ascii">
     _   _  ____  _____   _____ _   _ _____ _____ 
    | | | |  _  \|_   _| |_   _| | | | ____|  _  \
    | | | | |_| |  | |     | | | |_| | |__ | |_| |
    | | | |  _  /  | |     | | |  _  |  __||  _  / 
    | |_| | | \ \ _| |_    | | | | | | |___| | \ \ 
     \___/|_|  \_\_____|   |_| |_| |_|_____|_|  \_\
     [ THE TERRIBLE ASSASSIN DETECTED ]
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
        <div>
            <h3>OPERATOR_ID</h3>
            <input type="text" id="kaspaAddress" class="input-field" placeholder="yri.kas">
            <button id="connectBtn">INITIALIZE</button>
        </div>
        <div>
            <h3>RESOURCES</h3>
            <p>ENTROPY: 10/10</p>
            <p>DATA_CENTERS: 0 | DAEMONS: 0</p>
        </div>
    </div>

    <div class="log-area" id="logArea">> STANDBY...<br></div>
</div>

<script type="module">
    // Direct pathing for GitHub Pages
    import init, { RpcClient, Resolver, Encoding } from './kaspa.js';

    const log = document.getElementById('logArea');

    function logMsg(m) {
        log.innerHTML += `> ${m}<br>`;
        log.scrollTop = log.scrollHeight;
    }

    async function run() {
        try {
            logMsg("CONNECTING_TO_CORE...");
            // Force load the wasm from the current folder
            await init('./kaspa_bg.wasm');
            logMsg("CORE_LOADED.");
            logMsg("SYSTEM_READY.");

            document.getElementById('connectBtn').onclick = async () => {
                logMsg("RESOLVING_DAG_NODE...");
                const resolver = new Resolver();
                const url = await resolver.getUrl(Encoding.Borsh, "mainnet");
                const rpc = new RpcClient({ url, encoding: Encoding.Borsh, networkId: "mainnet" });
                
                try {
                    await rpc.connect();
                    logMsg("SUCCESS: LINK_ESTABLISHED.");
                    const info = await rpc.getInfo();
                    logMsg(`BLUE_SCORE: ${info.blueScore}`);
                } catch (e) { logMsg(`LINK_ERROR: ${e.message}`); }
            };
        } catch (e) {
            logMsg("CRITICAL: WASM_INIT_FAILED.");
            console.error(e);
        }
    }

    run();
</script>

</body>
</html>
